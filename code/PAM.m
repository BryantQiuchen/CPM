% PAM分解
function [g_kn,D_k] = PAM(h,L,M,sample_number,T)
% ARTM Tier II信号参数设置 L=3,M=4,h=4/16,5/16,脉冲成形为升余弦脉冲
% h=[4,5]/16;         %调制指数
% L=3;                %关联长度
% M=4;                %进制数
% A=1;                %幅度
% data_number=100;    %产生符号数
% sample_number=16;    %每符号采样点数
% R=50;               %符号率（波特率） 一秒钟内发送的符号数目
% T=1/R;              %符号周期
% fs=R*sample_number;  %采样率 每秒从连续信号中提取并组成离散信号的采样个数
% fc=200;             %载波频率

P=log2(M);
Q=2^(L-1);
N=Q^P*(2^P-1);

%---------------得到二进制分解系数Beta_k_i和C_k的持续时间D_k---------------%
[Beta_k_i,D_k]=GetBetakiDk(L);

% %---------------得到需要用到的基本参数E_array,通过E_array可以得到参数矩阵d_jl,e_mj---------------%
% E_array=GetEarray(D_k,M,L);
% d_jl=zeros(N,P);
% e_mj=zeros(N,P);
% if L==1
%     e_mj=E_array(:,1+(1:P));
% end
% if L~=1
%     d_jl=E_array(:,2+P+(1:P));
%     e_mj=E_array(:,2+2*P+(1:P));
% end

%---------------相位函数---------------%
tr=T/sample_number:T/sample_number:L*T;
wave=(1-cos(2*pi*tr/L/T))/2/L/T;        
temp_q=zeros(1,sample_number*L);
delt_T=T/sample_number;
temp_q(1)=wave(1)*delt_T;                   %对成型波形做面积积分
for i=2:sample_number*L
  temp_q(i)=temp_q(i-1)+wave(i)*delt_T;
  q=temp_q;
end

%---------------产生对应l=0,l=1的时变相位---------------%
h0_l=[h(1),2*h(1)];
h1_l=[h(2),2*h(2)];
fi1_0=2*pi*h0_l(1)*q;
fi1_1=2*pi*h0_l(2)*q;
fi2_0=2*pi*h1_l(1)*q;
fi2_1=2*pi*h1_l(2)*q;

%---------------产生组成成分中的基本函数u(t)---------------%
u0_l0=zeros(1,2*L*sample_number);
u0_l1=zeros(1,2*L*sample_number);
u1_l0=zeros(1,2*L*sample_number);
u1_l1=zeros(1,2*L*sample_number);

u0_l0(1:L*sample_number)=sin(fi1_0)/sin(pi*h0_l(1));        %l=0,第一个调制指数
u0_l0(L*sample_number+1:2*L*sample_number)=sin(pi*h0_l(1)-fi1_0)/sin(pi*h0_l(1));

u0_l1(1:L*sample_number)=sin(fi1_1)/sin(pi*h0_l(2));        %l=1,第一个调制指数
u0_l1(L*sample_number+1:2*L*sample_number)=sin(pi*h0_l(2)-fi1_1)/sin(pi*h0_l(2));

u1_l0(1:L*sample_number)=sin(fi2_0)/sin(pi*h1_l(1));        %l=0,第二个调制指数
u1_l0(L*sample_number+1:2*L*sample_number)=sin(pi*h1_l(1)-fi2_0)/sin(pi*h1_l(1));

u1_l1(1:L*sample_number)=sin(fi2_1)/sin(pi*h1_l(2));        %l=1,第二个调制指数
u1_l1(L*sample_number+1:2*L*sample_number)=sin(pi*h1_l(2)-fi2_1)/sin(pi*h1_l(2));

%----------------存放对应的波形g_kn----------------%
g_kn=cell(N,P);

%----------------c_kn暴力解，逐个列出----------------%
%c0
c0_l0odd=zeros(1,D_k(1)*sample_number);
c0_l0odd(1:sample_number)=u0_l0(1:(0+1)*sample_number)...
    .*u1_l0(sample_number+1:2*sample_number)...
    .*u0_l0(2*sample_number+1:3*sample_number);
c0_l0odd(sample_number+1:2*sample_number)=u0_l0(sample_number+1:2*sample_number)...
    .*u1_l0(2*sample_number+1:3*sample_number)...
    .*u1_l0(3*sample_number+1:4*sample_number);
c0_l0odd(2*sample_number+1:3*sample_number)=u0_l0(2*sample_number+1:3*sample_number)...
    .*u0_l0(3*sample_number+1:4*sample_number)...
    .*u1_l0(4*sample_number+1:5*sample_number);
c0_l0odd(3*sample_number+1:4*sample_number)=u1_l0(3*sample_number+1:4*sample_number)...
    .*u0_l0(4*sample_number+1:5*sample_number)...
    .*u1_l0(5*sample_number+1:6*sample_number);

c0_l0even=zeros(1,D_k(1)*sample_number);
c0_l0even(1:sample_number)=u1_l0(1:(0+1)*sample_number)...
    .*u0_l0(sample_number+1:2*sample_number)...
    .*u1_l0(2*sample_number+1:3*sample_number);
c0_l0even(sample_number+1:2*sample_number)=u1_l0(sample_number+1:2*sample_number)...
    .*u0_l0(2*sample_number+1:3*sample_number)...
    .*u0_l0(3*sample_number+1:4*sample_number);
c0_l0even(2*sample_number+1:3*sample_number)=u1_l0(2*sample_number+1:3*sample_number)...
    .*u1_l0(3*sample_number+1:4*sample_number)...
    .*u0_l0(4*sample_number+1:5*sample_number);
c0_l0even(3*sample_number+1:4*sample_number)=u0_l0(3*sample_number+1:4*sample_number)...
    .*u1_l0(4*sample_number+1:5*sample_number)...
    .*u0_l0(5*sample_number+1:6*sample_number);

c0_l1odd=zeros(1,D_k(1)*sample_number);
c0_l1odd(1:sample_number)=u0_l1(1:(0+1)*sample_number)...
    .*u1_l1(sample_number+1:2*sample_number)...
    .*u0_l1(2*sample_number+1:3*sample_number);
c0_l1odd(sample_number+1:2*sample_number)=u0_l1(sample_number+1:2*sample_number)...
    .*u1_l1(2*sample_number+1:3*sample_number)...
    .*u1_l1(3*sample_number+1:4*sample_number);
c0_l1odd(2*sample_number+1:3*sample_number)=u0_l1(2*sample_number+1:3*sample_number)...
    .*u0_l1(3*sample_number+1:4*sample_number)...
    .*u1_l1(4*sample_number+1:5*sample_number);
c0_l1odd(3*sample_number+1:4*sample_number)=u1_l1(3*sample_number+1:4*sample_number)...
    .*u0_l1(4*sample_number+1:5*sample_number)...
    .*u1_l1(5*sample_number+1:6*sample_number);

c0_l1even=zeros(1,D_k(1)*sample_number);
c0_l1even(1:sample_number)=u1_l1(1:(0+1)*sample_number)...
    .*u0_l1(sample_number+1:2*sample_number)...
    .*u1_l1(2*sample_number+1:3*sample_number);
c0_l1even(sample_number+1:2*sample_number)=u1_l1(sample_number+1:2*sample_number)...
    .*u0_l1(2*sample_number+1:3*sample_number)...
    .*u0_l1(3*sample_number+1:4*sample_number);
c0_l1even(2*sample_number+1:3*sample_number)=u1_l1(2*sample_number+1:3*sample_number)...
    .*u1_l1(3*sample_number+1:4*sample_number)...
    .*u0_l1(4*sample_number+1:5*sample_number);
c0_l1even(3*sample_number+1:4*sample_number)=u0_l1(3*sample_number+1:4*sample_number)...
    .*u1_l1(4*sample_number+1:5*sample_number)...
    .*u0_l1(5*sample_number+1:6*sample_number);

%c1
c1_l0odd=zeros(1,D_k(2)*sample_number);
c1_l0odd(1:sample_number)=u0_l0(1:sample_number)...
    .*u1_l0(4*sample_number+1:5*sample_number)...
    .*u0_l0(2*sample_number+1:3*sample_number);
c1_l0odd(sample_number+1:2*sample_number)=u0_l0(sample_number+1:2*sample_number)...
    .*u1_l0(5*sample_number+1:6*sample_number)...
    .*u1_l0(3*sample_number+1:4*sample_number);

c1_l0even=zeros(1,D_k(2)*sample_number);
c1_l0even(1:sample_number)=u1_l0(1:sample_number)...
    .*u0_l0(4*sample_number+1:5*sample_number)...
    .*u1_l0(2*sample_number+1:3*sample_number);
c1_l0even(sample_number+1:2*sample_number)=u1_l0(sample_number+1:2*sample_number)...
    .*u0_l0(5*sample_number+1:6*sample_number)...
    .*u0_l0(3*sample_number+1:4*sample_number);

c1_l1odd=zeros(1,D_k(2)*sample_number);
c1_l1odd(1:sample_number)=u0_l1(1:sample_number)...
    .*u1_l1(4*sample_number+1:5*sample_number)...
    .*u0_l1(2*sample_number+1:3*sample_number);
c1_l1odd(sample_number+1:2*sample_number)=u0_l1(sample_number+1:2*sample_number)...
    .*u1_l1(5*sample_number+1:6*sample_number)...
    .*u1_l1(3*sample_number+1:4*sample_number);

c1_l1even=zeros(1,D_k(2)*sample_number);
c1_l1even(1:sample_number)=u1_l1(1:sample_number)...
    .*u0_l1(4*sample_number+1:5*sample_number)...
    .*u1_l1(2*sample_number+1:3*sample_number);
c1_l1even(sample_number+1:2*sample_number)=u1_l1(sample_number+1:2*sample_number)...
    .*u0_l1(5*sample_number+1:6*sample_number)...
    .*u0_l1(3*sample_number+1:4*sample_number);

%c2
c2_l0odd=zeros(1,D_k(3)*sample_number);
c2_l0odd(1:sample_number)=u0_l0(1:sample_number)...
    .*u1_l0(sample_number+1:2*sample_number)...
    .*u0_l0(5*sample_number+1:6*sample_number);

c2_l0even=zeros(1,D_k(3)*sample_number);
c2_l0even(1:sample_number)=u1_l0(1:sample_number)...
    .*u0_l0(sample_number+1:2*sample_number)...
    .*u1_l0(5*sample_number+1:6*sample_number);

c2_l1odd=zeros(1,D_k(3)*sample_number);
c2_l1odd(1:sample_number)=u0_l1(1:sample_number)...
    .*u1_l1(sample_number+1:2*sample_number)...
    .*u0_l1(5*sample_number+1:6*sample_number);

c2_l1even=zeros(1,D_k(3)*sample_number);
c2_l1even(1:sample_number)=u1_l1(1:sample_number)...
    .*u0_l1(sample_number+1:2*sample_number)...
    .*u1_l1(5*sample_number+1:6*sample_number);

%c3
c3_l0odd=zeros(1,D_k(4)*sample_number);
c3_l0odd(1:sample_number)=u0_l0(1:sample_number)...
    .*u1_l0(4*sample_number+1:(D_k(4)+4)*sample_number)...
    .*u0_l0(5*sample_number+1:(D_k(4)+5)*sample_number);

c3_l0even=zeros(1,D_k(4)*sample_number);
c3_l0even(1:sample_number)=u1_l0(1:sample_number)...
    .*u0_l0(4*sample_number+1:(D_k(4)+4)*sample_number)...
    .*u1_l0(5*sample_number+1:(D_k(4)+5)*sample_number);

c3_l1odd=zeros(1,D_k(4)*sample_number);
c3_l1odd(1:sample_number)=u0_l1(1:sample_number)...
    .*u1_l1(4*sample_number+1:(D_k(4)+4)*sample_number)...
    .*u0_l1(5*sample_number+1:(D_k(4)+5)*sample_number);

c3_l1even=zeros(1,D_k(4)*sample_number);
c3_l1even(1:sample_number)=u1_l1(1:sample_number)...
    .*u0_l1(4*sample_number+1:(D_k(4)+4)*sample_number)...
    .*u1_l1(5*sample_number+1:(D_k(4)+5)*sample_number);


%----------------奇数时刻表示g_kn(j=dj0+Q*dj1)----------------%
% j=0(dj0=0,dj1=0),M0=7,k=0-6
g_kn{1,1}=c0_l0odd(1:D_k(1)*sample_number)...
    .*c0_l1odd(1:D_k(1)*sample_number);
g_kn{2,1}=c0_l0even(sample_number+1:D_k(1)*sample_number)...
    .*c0_l1odd(1:(D_k(1)-1)*sample_number);
g_kn{3,1}=c0_l0odd(1:(D_k(1)-1)*sample_number)...
    .*c0_l1even(sample_number+1:D_k(1)*sample_number);
g_kn{4,1}=c0_l0odd(2*sample_number+1:D_k(1)*sample_number)...
    .*c0_l1odd(1:2*sample_number);
g_kn{5,1}=c0_l0odd(1:2*sample_number)...
    .*c0_l1odd(2*sample_number+1:D_k(1)*sample_number);
g_kn{6,1}=c0_l0even(3*sample_number+1:D_k(1)*sample_number)...
    .*c0_l1odd(1:sample_number);
g_kn{7,1}=c0_l0odd(1:sample_number)...
    .*c0_l1even(3*sample_number+1:D_k(1)*sample_number);

% j=1(dj0=1,dj1=0),M1=5,k=7-11
g_kn{8,1}=c1_l0odd(1:D_k(2)*sample_number)...
    .*c0_l1odd(1:D_k(2)*sample_number);
g_kn{9,1}=c1_l0even(sample_number+1:D_k(2)*sample_number)...
    .*c0_l1odd(1:sample_number);
g_kn{10,1}=c1_l0odd(1:D_k(2)*sample_number)...
    .*c0_l1even(sample_number+1:(D_k(2)+1)*sample_number);
g_kn{11,1}=c1_l0odd(1:D_k(2)*sample_number)...
    .*c0_l1odd(2*sample_number+1:(D_k(2)+2)*sample_number);
g_kn{12,1}=c1_l0odd(1:(D_k(2)-1)*sample_number)...
    .*c0_l1even(3*sample_number+1:4*sample_number);

% j=2(dj0=2,dj1=0),M2=4,k=12-15
g_kn{13,1}=c2_l0odd(1:sample_number)...
    .*c0_l1odd(1:sample_number);
g_kn{14,1}=c2_l0odd(1:sample_number)...
    .*c0_l1even(sample_number+1:2*sample_number);
g_kn{15,1}=c2_l0odd(1:sample_number)...
    .*c0_l1odd(2*sample_number+1:3*sample_number);
g_kn{16,1}=c2_l0odd(1:sample_number)...
    .*c0_l1even(3*sample_number+1:4*sample_number);

% j=3(dj0=3,dj1=0),M3=4,k=16-19
g_kn{17,1}=c3_l0odd(1:sample_number)...
    .*c0_l1odd(1:sample_number);
g_kn{18,1}=c3_l0odd(1:sample_number)...
    .*c0_l1even(sample_number+1:2*sample_number);
g_kn{19,1}=c3_l0odd(1:sample_number)...
    .*c0_l1even(2*sample_number+1:3*sample_number);
g_kn{20,1}=c3_l0odd(1:sample_number)...
    .*c0_l1even(3*sample_number+1:4*sample_number);

% j=4(dj0=0,dj1=1),M4=5,k=20-24
g_kn{21,1}=c0_l0odd(1:2*sample_number)...
    .*c1_l1odd(1:2*sample_number);
g_kn{22,1}=c0_l0even(sample_number+1:3*sample_number)...
    .*c1_l1odd(1:2*sample_number);
g_kn{23,1}=c0_l0odd(1:sample_number)...
    .*c1_l1even(sample_number+1:2*sample_number);
g_kn{24,1}=c0_l0odd(2*sample_number+1:4*sample_number)...
    .*c1_l1odd(1:2*sample_number);
g_kn{25,1}=c0_l0even(3*sample_number+1:4*sample_number)...
    .*c1_l1odd(1:sample_number);

% j=5(dj0=1,dj1=1),M5=3,k=25-27
g_kn{26,1}=c1_l0odd(1:2*sample_number)...
    .*c1_l1odd(1:2*sample_number);
g_kn{27,1}=c1_l0even(sample_number+1:2*sample_number)...
    .*c1_l1odd(1:sample_number);
g_kn{28,1}=c1_l0odd(1:sample_number)...
    .*c1_l1even(sample_number+1:2*sample_number);

% j=6(dj0=2,dj1=1),M6=2,k=28-29
g_kn{29,1}=c2_l0odd(1:sample_number)...
    .*c1_l1odd(1:sample_number);
g_kn{30,1}=c2_l0odd(1:sample_number)...
    .*c1_l1even(sample_number+1:2*sample_number);

% j=7(dj0=3,dj1=1),M7=2,k=30-31
g_kn{31,1}=c3_l0odd(1:sample_number)...
    .*c1_l1odd(1:sample_number);
g_kn{32,1}=c3_l0odd(1:sample_number)...
    .*c1_l1even(sample_number+1:2*sample_number);

% j=8(dj0=0,dj1=2),M8=4,k=32-35
g_kn{33,1}=c0_l0odd(1:sample_number)...
    .*c2_l1odd(1:sample_number);
g_kn{34,1}=c0_l0even(sample_number+1:2*sample_number)...
    .*c2_l1odd(1:sample_number);
g_kn{35,1}=c0_l0odd(2*sample_number+1:3*sample_number)...
    .*c2_l1odd(1:sample_number);
g_kn{36,1}=c0_l0even(3*sample_number+1:4*sample_number)...
    .*c2_l1odd(1:sample_number);

% j=9(dj0=1,dj1=2),M9=2,k=36-37
g_kn{37,1}=c1_l0odd(1:sample_number)...
    .*c2_l1odd(1:sample_number);
g_kn{38,1}=c1_l0even(sample_number+1:2*sample_number)...
    .*c2_l1odd(1:sample_number);

% j=10(dj0=2,dj1=2),M10=1,k=38
g_kn{39,1}=c2_l0odd(1:sample_number)...
    .*c2_l1odd(1:sample_number);

% j=11(dj0=3,dj1=2),M11=1,k=39
g_kn{40,1}=c3_l0odd(1:sample_number)...
    .*c2_l1odd(1:sample_number);

% j=12(dj0=0,dj1=3),M12=4,k=40-43
g_kn{41,1}=c0_l0odd(1:sample_number)...
    .*c3_l1odd(1:sample_number);
g_kn{42,1}=c0_l0even(sample_number+1:2*sample_number)...
    .*c3_l1odd(1:sample_number);
g_kn{43,1}=c0_l0odd(2*sample_number+1:3*sample_number)...
    .*c3_l1odd(1:sample_number);
g_kn{44,1}=c0_l0even(3*sample_number+1:4*sample_number)...
    .*c3_l1odd(1:sample_number);

% j=13(dj0=1,dj1=3),M13=2,k=44-45
g_kn{45,1}=c1_l0odd(1:sample_number)...
    .*c3_l1odd(1:sample_number);
g_kn{46,1}=c1_l0even(sample_number+1:2*sample_number)...
    .*c3_l1odd(1:sample_number);

% j=14(dj0=2,dj1=3),M14=1,k=46
g_kn{47,1}=c2_l0odd(1:sample_number)...
    .*c3_l1odd(1:sample_number);

% j=15(dj0=3,dj1=3),M15=1,k=47
g_kn{48,1}=c3_l0odd(1:sample_number)...
    .*c3_l1odd(1:sample_number);

%----------------奇数时刻作图----------------%
% figure
% plot((1:64)/sample_number,g_kn{1,1},(1:48)/sample_number,g_kn{2,1},...
%     (1:48)/sample_number,g_kn{3,1},(1:32)/sample_number,g_kn{4,1},...
%     (1:32)/sample_number,g_kn{5,1},(1:16)/sample_number,g_kn{6,1},...
%     (1:16)/sample_number,g_kn{7,1},(1:32)/sample_number,g_kn{8,1},...
%     (1:16)/sample_number,g_kn{9,1},(1:32)/sample_number,g_kn{10,1},...
%     (1:32)/sample_number,g_kn{11,1},(1:16)/sample_number,g_kn{12,1},...
%     (1:16)/sample_number,g_kn{13,1},(1:16)/sample_number,g_kn{14,1},...
%     (1:16)/sample_number,g_kn{15,1},(1:16)/sample_number,g_kn{16,1},...
%     (1:16)/sample_number,g_kn{17,1},(1:16)/sample_number,g_kn{18,1},...
%     (1:16)/sample_number,g_kn{19,1},(1:16)/sample_number,g_kn{20,1},...
%     (1:32)/sample_number,g_kn{21,1},(1:32)/sample_number,g_kn{22,1},...
%     (1:16)/sample_number,g_kn{23,1},(1:32)/sample_number,g_kn{24,1},...
%     (1:16)/sample_number,g_kn{25,1},(1:32)/sample_number,g_kn{26,1},...
%     (1:16)/sample_number,g_kn{27,1},(1:16)/sample_number,g_kn{28,1},...
%     (1:16)/sample_number,g_kn{29,1},(1:16)/sample_number,g_kn{30,1},...
%     (1:16)/sample_number,g_kn{31,1},(1:16)/sample_number,g_kn{32,1},...
%     (1:16)/sample_number,g_kn{33,1},(1:16)/sample_number,g_kn{34,1},...
%     (1:16)/sample_number,g_kn{35,1},(1:16)/sample_number,g_kn{36,1},...
%     (1:16)/sample_number,g_kn{37,1},(1:16)/sample_number,g_kn{38,1},...
%     (1:16)/sample_number,g_kn{39,1},(1:16)/sample_number,g_kn{40,1},...
%     (1:16)/sample_number,g_kn{41,1},(1:16)/sample_number,g_kn{42,1},...
%     (1:16)/sample_number,g_kn{43,1},(1:16)/sample_number,g_kn{44,1},...
%     (1:16)/sample_number,g_kn{45,1},(1:16)/sample_number,g_kn{46,1},...
%     (1:16)/sample_number,g_kn{47,1},(1:16)/sample_number,g_kn{48,1});
% axis([0 4 0 0.8]);
% xlabel("归一化时间t/T");
% ylabel("幅度");
% title("奇数时刻");
% grid on

%----------------偶数时刻表示g_kn(j=dj0+Q*dj1)----------------%
% j=0(dj0=0,dj1=0),M0=7,k=0-6
g_kn{1,2}=c0_l0even(1:D_k(1)*sample_number)...
    .*c0_l1even(1:D_k(1)*sample_number);
g_kn{2,2}=c0_l0odd(sample_number+1:D_k(1)*sample_number)...
    .*c0_l1even(1:(D_k(1)-1)*sample_number);
g_kn{3,2}=c0_l0even(1:(D_k(1)-1)*sample_number)...
    .*c0_l1odd(sample_number+1:D_k(1)*sample_number);
g_kn{4,2}=c0_l0even(2*sample_number+1:D_k(1)*sample_number)...
    .*c0_l1even(1:2*sample_number);
g_kn{5,2}=c0_l0even(1:2*sample_number)...
    .*c0_l1even(2*sample_number+1:D_k(1)*sample_number);
g_kn{6,2}=c0_l0odd(3*sample_number+1:D_k(1)*sample_number)...
    .*c0_l1even(1:sample_number);
g_kn{7,2}=c0_l0even(1:sample_number)...
    .*c0_l1odd(3*sample_number+1:D_k(1)*sample_number);

% j=1(dj0=1,dj1=0),M1=5,k=7-11
g_kn{8,2}=c1_l0even(1:D_k(2)*sample_number)...
    .*c0_l1even(1:D_k(2)*sample_number);
g_kn{9,2}=c1_l0odd(sample_number+1:D_k(2)*sample_number)...
    .*c0_l1even(1:sample_number);
g_kn{10,2}=c1_l0even(1:D_k(2)*sample_number)...
    .*c0_l1odd(sample_number+1:(D_k(2)+1)*sample_number);
g_kn{11,2}=c1_l0even(1:D_k(2)*sample_number)...
    .*c0_l1even(2*sample_number+1:(D_k(2)+2)*sample_number);
g_kn{12,2}=c1_l0even(1:(D_k(2)-1)*sample_number)...
    .*c0_l1odd(3*sample_number+1:4*sample_number);

% j=2(dj0=2,dj1=0),M2=4,k=12-15
g_kn{13,2}=c2_l0even(1:sample_number)...
    .*c0_l1even(1:sample_number);
g_kn{14,2}=c2_l0even(1:sample_number)...
    .*c0_l1odd(sample_number+1:2*sample_number);
g_kn{15,2}=c2_l0even(1:sample_number)...
    .*c0_l1even(2*sample_number+1:3*sample_number);
g_kn{16,2}=c2_l0even(1:sample_number)...
    .*c0_l1odd(3*sample_number+1:4*sample_number);

% j=3(dj0=3,dj1=0),M3=4,k=16-19
g_kn{17,2}=c3_l0even(1:sample_number)...
    .*c0_l1even(1:sample_number);
g_kn{18,2}=c3_l0even(1:sample_number)...
    .*c0_l1odd(sample_number+1:2*sample_number);
g_kn{19,2}=c3_l0even(1:sample_number)...
    .*c0_l1odd(2*sample_number+1:3*sample_number);
g_kn{20,2}=c3_l0even(1:sample_number)...
    .*c0_l1odd(3*sample_number+1:4*sample_number);

% j=4(dj0=0,dj1=1),M4=5,k=20-24
g_kn{21,2}=c0_l0even(1:2*sample_number)...
    .*c1_l1even(1:2*sample_number);
g_kn{22,2}=c0_l0odd(sample_number+1:3*sample_number)...
    .*c1_l1even(1:2*sample_number);
g_kn{23,2}=c0_l0even(1:sample_number)...
    .*c1_l1odd(sample_number+1:2*sample_number);
g_kn{24,2}=c0_l0even(2*sample_number+1:4*sample_number)...
    .*c1_l1even(1:2*sample_number);
g_kn{25,2}=c0_l0odd(3*sample_number+1:4*sample_number)...
    .*c1_l1even(1:sample_number);

% j=5(dj0=1,dj1=1),M5=3,k=25-27
g_kn{26,2}=c1_l0even(1:2*sample_number)...
    .*c1_l1even(1:2*sample_number);
g_kn{27,2}=c1_l0odd(sample_number+1:2*sample_number)...
    .*c1_l1even(1:sample_number);
g_kn{28,2}=c1_l0even(1:sample_number)...
    .*c1_l1odd(sample_number+1:2*sample_number);

% j=6(dj0=2,dj1=1),M6=2,k=28-29
g_kn{29,2}=c2_l0even(1:sample_number)...
    .*c1_l1even(1:sample_number);
g_kn{30,2}=c2_l0even(1:sample_number)...
    .*c1_l1odd(sample_number+1:2*sample_number);

% j=7(dj0=3,dj1=1),M7=2,k=30-31
g_kn{31,2}=c3_l0even(1:sample_number)...
    .*c1_l1even(1:sample_number);
g_kn{32,2}=c3_l0even(1:sample_number)...
    .*c1_l1odd(sample_number+1:2*sample_number);

% j=8(dj0=0,dj1=2),M8=4,k=32-35
g_kn{33,2}=c0_l0even(1:sample_number)...
    .*c2_l1even(1:sample_number);
g_kn{34,2}=c0_l0odd(sample_number+1:2*sample_number)...
    .*c2_l1even(1:sample_number);
g_kn{35,2}=c0_l0even(2*sample_number+1:3*sample_number)...
    .*c2_l1even(1:sample_number);
g_kn{36,2}=c0_l0odd(3*sample_number+1:4*sample_number)...
    .*c2_l1even(1:sample_number);

% j=9(dj0=1,dj1=2),M9=2,k=36-37
g_kn{37,2}=c1_l0even(1:sample_number)...
    .*c2_l1even(1:sample_number);
g_kn{38,2}=c1_l0odd(sample_number+1:2*sample_number)...
    .*c2_l1even(1:sample_number);

% j=10(dj0=2,dj1=2),M10=1,k=38
g_kn{39,2}=c2_l0even(1:sample_number)...
    .*c2_l1even(1:sample_number);

% j=11(dj0=3,dj1=2),M11=1,k=39
g_kn{40,2}=c3_l0even(1:sample_number)...
    .*c2_l1even(1:sample_number);

% j=12(dj0=0,dj1=3),M12=4,k=40-43
g_kn{41,2}=c0_l0even(1:sample_number)...
    .*c3_l1even(1:sample_number);
g_kn{42,2}=c0_l0odd(sample_number+1:2*sample_number)...
    .*c3_l1even(1:sample_number);
g_kn{43,2}=c0_l0even(2*sample_number+1:3*sample_number)...
    .*c3_l1even(1:sample_number);
g_kn{44,2}=c0_l0odd(3*sample_number+1:4*sample_number)...
    .*c3_l1even(1:sample_number);

% j=13(dj0=1,dj1=3),M13=2,k=44-45
g_kn{45,2}=c1_l0even(1:sample_number)...
    .*c3_l1even(1:sample_number);
g_kn{46,2}=c1_l0odd(sample_number+1:2*sample_number)...
    .*c3_l1even(1:sample_number);

% j=14(dj0=2,dj1=3),M14=1,k=46
g_kn{47,2}=c2_l0even(1:sample_number)...
    .*c3_l1even(1:sample_number);

% j=15(dj0=3,dj1=3),M15=1,k=47
g_kn{48,2}=c3_l0even(1:sample_number)...
    .*c3_l1even(1:sample_number);

%----------------偶数时刻作图----------------%
% figure
% plot((1:64)/sample_number,g_kn{1,2},(1:48)/sample_number,g_kn{2,2},...
%     (1:48)/sample_number,g_kn{3,2},(1:32)/sample_number,g_kn{4,2},...
%     (1:32)/sample_number,g_kn{5,2},(1:16)/sample_number,g_kn{6,2},...
%     (1:16)/sample_number,g_kn{7,2},(1:32)/sample_number,g_kn{8,2},...
%     (1:16)/sample_number,g_kn{9,2},(1:32)/sample_number,g_kn{10,2},...
%     (1:32)/sample_number,g_kn{11,2},(1:16)/sample_number,g_kn{12,2},...
%     (1:16)/sample_number,g_kn{13,2},(1:16)/sample_number,g_kn{14,2},...
%     (1:16)/sample_number,g_kn{15,2},(1:16)/sample_number,g_kn{16,2},...
%     (1:16)/sample_number,g_kn{17,2},(1:16)/sample_number,g_kn{18,2},...
%     (1:16)/sample_number,g_kn{19,2},(1:16)/sample_number,g_kn{20,2},...
%     (1:32)/sample_number,g_kn{21,2},(1:32)/sample_number,g_kn{22,2},...
%     (1:16)/sample_number,g_kn{23,2},(1:32)/sample_number,g_kn{24,2},...
%     (1:16)/sample_number,g_kn{25,2},(1:32)/sample_number,g_kn{26,2},...
%     (1:16)/sample_number,g_kn{27,2},(1:16)/sample_number,g_kn{28,2},...
%     (1:16)/sample_number,g_kn{29,2},(1:16)/sample_number,g_kn{30,2},...
%     (1:16)/sample_number,g_kn{31,2},(1:16)/sample_number,g_kn{32,2},...
%     (1:16)/sample_number,g_kn{33,2},(1:16)/sample_number,g_kn{34,2},...
%     (1:16)/sample_number,g_kn{35,2},(1:16)/sample_number,g_kn{36,2},...
%     (1:16)/sample_number,g_kn{37,2},(1:16)/sample_number,g_kn{38,2},...
%     (1:16)/sample_number,g_kn{39,2},(1:16)/sample_number,g_kn{40,2},...
%     (1:16)/sample_number,g_kn{41,2},(1:16)/sample_number,g_kn{42,2},...
%     (1:16)/sample_number,g_kn{43,2},(1:16)/sample_number,g_kn{44,2},...
%     (1:16)/sample_number,g_kn{45,2},(1:16)/sample_number,g_kn{46,2},...
%     (1:16)/sample_number,g_kn{47,2},(1:16)/sample_number,g_kn{48,2});
% axis([0 4 0 0.8]);
% xlabel("归一化时间t/T");
% ylabel("幅度");
% title("偶数时刻");
% grid on
end
